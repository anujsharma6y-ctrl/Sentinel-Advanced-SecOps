import re
import os

"""
Credential Leak Scanner (Bulk Folder Mode)
Description: Recursively scans all files in a directory for sensitive leaks.
"""

def scan_file_for_leaks(file_path):
    patterns = {
        "Google API Key": r"AIza[0-9A-Za-z-_]{35}",
        "Generic Password": r"password\s*=\s*['\"].*['\"]",
        "Credit Card Number": r"\b(?:\d{4}[ -]?){3}\d{4}\b",
        "RSA Private Key": r"-----BEGIN RSA PRIVATE KEY-----"
    }

    try:
        # Some files (like images/binaries) can't be read as text
        with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
            content = f.read()
            for secret_type, pattern in patterns.items():
                matches = re.findall(pattern, content)
                if matches:
                    print(f"\n CRITICAL LEAK in: {file_path}")
                    print(f"   Type: {secret_type}")
                    for match in matches:
                        print(f"   [!] Data: {match}")
    except Exception as e:
        # Silently skip files that can't be opened (like system files)
        pass

def scan_folder(folder_path):
    print(f" Starting Bulk Scan in: {folder_path}")
    print("-" * 50)
    
    # os.walk traverses the directory tree
    for root, dirs, files in os.walk(folder_path):
        for file in files:
            # Join the folder path and file name
            file_path = os.path.join(root, file)
            scan_file_for_leaks(file_path)
    
    print("\n Bulk Scan Completed.")

if __name__ == "__main__":
    target = input("Enter the Folder Path to scan (e.g., . for current folder): ")
    if os.path.isdir(target):
        scan_folder(target)
    else:
        # If it's just a single file, scan it directly
        scan_file_for_leaks(target)